<h1>Real-Time Product List</h1>
<ul id="product-list">
    {{#each products}}
    <li data-id="{{this.id}}">
        <strong>Title:</strong> {{this.title}} <br>
        <strong>Description:</strong> {{this.description}} <br>
        <strong>Code:</strong> {{this.code}} <br>
        <strong>Price:</strong> ${{this.price}} <br>
        <strong>Status:</strong> {{this.status}} <br>
        <strong>Stock:</strong> {{this.stock}} <br>
        <strong>Category:</strong> {{this.category}} <br>
        <strong>Thumbnails:</strong> {{#each this.thumbnails}}<img src="{{this}}" alt="thumbnail">{{/each}} <br>
    </li>
    {{/each}}
</ul>

<form id="add-product-form">
    <input type="text" id="title" placeholder="Title" required>
    <input type="text" id="description" placeholder="Description" required>
    <input type="text" id="code" placeholder="Code" required>
    <input type="number" id="price" placeholder="Price" required>
    <input type="checkbox" id="status"> Status
    <input type="number" id="stock" placeholder="Stock" required>
    <input type="text" id="category" placeholder="Category" required>
    <input type="text" id="thumbnails" placeholder="Thumbnails (comma separated)" required>
    <button type="submit">Add Product</button>
</form>

<div id="messages"></div>

<script src="/socket.io/socket.io.js"></script>
<script>
    const socket = io();

    socket.on('product-added', (product) => {
        const productList = document.getElementById('product-list');
        const newProduct = document.createElement('li');
        newProduct.innerHTML = `
            <strong>Title:</strong> ${product.title} <br>
            <strong>Description:</strong> ${product.description} <br>
            <strong>Code:</strong> ${product.code} <br>
            <strong>Price:</strong> $${product.price} <br>
            <strong>Status:</strong> ${product.status} <br>
            <strong>Stock:</strong> ${product.stock} <br>
            <strong>Category:</strong> ${product.category} <br>
            <strong>Thumbnails:</strong> ${product.thumbnails.map(url => `<img src="${url}" alt="thumbnail">`).join(' ')}
        `;
        newProduct.setAttribute('data-id', product.id);
        productList.appendChild(newProduct);
    });

    socket.on('product-deleted', (productId) => {
        const productList = document.getElementById('product-list');
        const productItem = productList.querySelector(`li[data-id="${productId}"]`);
        if (productItem) {
            productList.removeChild(productItem);
        }
    });

    document.getElementById('add-product-form').addEventListener('submit', (e) => {
        e.preventDefault();
        const title = document.getElementById('title').value;
        const description = document.getElementById('description').value;
        const code = document.getElementById('code').value;
        const price = document.getElementById('price').value;
        const status = document.getElementById('status').checked;
        const stock = document.getElementById('stock').value;
        const category = document.getElementById('category').value;
        const thumbnails = document.getElementById('thumbnails').value.split(',').map(url => url.trim());

        fetch('/api/products', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({ title, description, code, price, status, stock, category, thumbnails })
        }).then(response => response.json()).then(data => {
            if (data.status === 'success') {
                document.getElementById('title').value = '';
                document.getElementById('description').value = '';
                document.getElementById('code').value = '';
                document.getElementById('price').value = '';
                document.getElementById('status').checked = false;
                document.getElementById('stock').value = '';
                document.getElementById('category').value = '';
                document.getElementById('thumbnails').value = '';
            }
        });
    });
</script>
